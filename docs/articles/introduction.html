<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Introduction to eemR • eemR</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><script src="introduction_files/libs/quarto-html/popper.min.js"></script><script src="introduction_files/libs/quarto-html/tippy.umd.min.js"></script><link href="introduction_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="introduction_files/libs/quarto-html/light-border.css" rel="stylesheet">
<!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Introduction to eemR">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">eemR</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.0.2.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/custom-import-function.html">Creating custom import functions</a></li>
    <li><a class="dropdown-item" href="../articles/introduction.html">Introduction to eemR</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/PMassicotte/eemR/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-quarto">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1></h1>

      <p class="author">Philippe Massicotte</p>
      <p class="date">2025-03-25</p>

      <small class="dont-index">Source: <a href="https://github.com/PMassicotte/eemR/blob/HEAD/vignettes/introduction.qmd" class="external-link"><code>vignettes/introduction.qmd</code></a></small>
      <div class="d-none name"><code></code></div>
    </div>






    <header id="title-block-header" class="quarto-title-block"><h1 class="title">Introduction to eemR</h1></header><section class="section level3"><h3 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h3>
<p>Dissolved organic matter (DOM) plays a central role in the functioning of aquatic ecosystems. For example, characteristics of the DOM pool (quantity and quality) determine underwater light climate <span class="citation" data-cites="Kirk1994">(<a href="#ref-Kirk1994" role="doc-biblioref">Kirk 1994</a>)</span>, the composition of aquatic microbial communities <span class="citation" data-cites="Foreman2003 Kritzberg2006a">(<a href="#ref-Foreman2003" role="doc-biblioref">Foreman and Covert 2003</a>; <a href="#ref-Kritzberg2006a" role="doc-biblioref">Kritzberg et al. 2006</a>)</span> and the carbon cycling on local to global scales <span class="citation" data-cites="Cole2007">(<a href="#ref-Cole2007" role="doc-biblioref">Cole et al. 2007</a>)</span>. Chemically, the DOM pool is complex (&gt; 1500 compounds) and analytical methods used to characterize it are relatively complex, time-consuming and costly <span class="citation" data-cites="Benner2002 Seitzinger2005 Fellman2010">(<a href="#ref-Benner2002" role="doc-biblioref">Benner 2002</a>; <a href="#ref-Seitzinger2005" role="doc-biblioref">Seitzinger et al. 2005</a>; <a href="#ref-Fellman2010" role="doc-biblioref">Fellman, Hood, and Spencer 2010</a>)</span>. This situation called for the development of rapid and cost effective characterization techniques. Because optical properties of DOM can be related to its chemical properties, optical techniques such as fluorescence spectroscopy have been developed and rapidly adopted by the community to characterize the DOM pool in aquatic ecosystems <span class="citation" data-cites="Coble1990 Coble1996 McKnight2001">(<a href="#ref-Coble1990" role="doc-biblioref">Paula G. Coble et al. 1990</a>; <a href="#ref-Coble1996" role="doc-biblioref">Paula G. Coble 1996</a>; <a href="#ref-McKnight2001" role="doc-biblioref">McKnight et al. 2001</a>)</span>.</p>
<p>The seminal paper of <span class="citation" data-cites="Stedmon2003a">(<a href="#ref-Stedmon2003a" role="doc-biblioref">Stedmon, Markager, and Bro 2003</a>)</span> put at the forefront the use of parallel factor analysis (PARAFAC) to aid the characterization of fluorescent DOM. Briefly, this three-way technique allows the decomposition of complex DOM fluorescence signals contained in the excitation-emission matrix (EEM, Fig. 1) into a set of individual chemical components and provides estimations of their relative contribution to the total fluorescence <span class="citation" data-cites="Bro1997 Fellman2010 Stedmon2003a">(<a href="#ref-Bro1997" role="doc-biblioref">Bro 1997</a>; <a href="#ref-Fellman2010" role="doc-biblioref">Fellman, Hood, and Spencer 2010</a>; <a href="#ref-Stedmon2003a" role="doc-biblioref">Stedmon, Markager, and Bro 2003</a>)</span>.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure><p><img src="introduction_files/figure-html/unnamed-chunk-1-1.png" width="480"></p>
<figcaption>Example of an excitation-emission fluorescence matrix (EEM). The diagonal structure with high fluorescence corresponds to the first order of Rayleigh scattering.</figcaption></figure>
</div>
</div>
</div>
<p>The PARAFAC model is described as <span class="citation" data-cites="Bro1997 Harshman1970">(<a href="#ref-Bro1997" role="doc-biblioref">Bro 1997</a>; <a href="#ref-Harshman1970" role="doc-biblioref">Harshman 1970</a>)</span>:</p>
<div class="equation">
<ol class="example" type="1">
<li><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>x</mi><mrow><mi>i</mi><mi>j</mi><mi>k</mi></mrow></msub><mo>=</mo><munderover><mo>∑</mo><mrow><mi>f</mi><mo>=</mo><mn>1</mn></mrow><mi>F</mi></munderover><msub><mi>a</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><msub><mi>b</mi><mrow><mi>j</mi><mi>f</mi></mrow></msub><msub><mi>c</mi><mrow><mi>k</mi><mi>f</mi></mrow></msub><mo>+</mo><msub><mi>e</mi><mrow><mi>i</mi><mi>j</mi><mi>k</mi></mrow></msub></mrow><annotation encoding="application/x-tex">x_{ijk} = \sum_{f=1}^{F} a_{ij}b_{jf}c_{kf} + e_{ijk}</annotation></semantics></math></li>
</ol>
</div>
<p>where <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi><mo>=</mo><mn>1</mn><mo>,</mo><mi>.</mi><mi>.</mi><mi>.</mi><mo>,</mo><mi>I</mi></mrow><annotation encoding="application/x-tex">i = 1, ..., I</annotation></semantics></math>; <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>j</mi><mo>=</mo><mn>1</mn><mo>,</mo><mi>.</mi><mi>.</mi><mi>.</mi><mo>,</mo><mi>J</mi></mrow><annotation encoding="application/x-tex">j = 1, ..., J</annotation></semantics></math>; <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi><mo>=</mo><mn>1</mn><mo>,</mo><mi>.</mi><mi>.</mi><mi>.</mi><mo>,</mo><mi>K</mi></mrow><annotation encoding="application/x-tex">k = 1, ..., K</annotation></semantics></math>, <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>x</mi><mrow><mi>i</mi><mi>j</mi><mi>k</mi></mrow></msub><annotation encoding="application/x-tex">x_{ijk}</annotation></semantics></math> is the intensity of fluorescence of the the <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msup><mi>i</mi><mrow><mi>t</mi><mi>h</mi></mrow></msup><annotation encoding="application/x-tex">i^{th}</annotation></semantics></math> sample at the <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msup><mi>j</mi><mrow><mi>t</mi><mi>h</mi></mrow></msup><annotation encoding="application/x-tex">j^{th}</annotation></semantics></math> emission wavelength at the <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msup><mi>k</mi><mrow><mi>t</mi><mi>h</mi></mrow></msup><annotation encoding="application/x-tex">k^{th}</annotation></semantics></math> excitation wavelength. <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>a</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><annotation encoding="application/x-tex">a_{ij}</annotation></semantics></math> is directly proportional to the concentration of the <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msup><mi>f</mi><mrow><mi>t</mi><mi>h</mi></mrow></msup><annotation encoding="application/x-tex">f^{th}</annotation></semantics></math> component in the sample <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>i</mi><annotation encoding="application/x-tex">i</annotation></semantics></math>. Although PARAFAC gained a lot of attention in environmental sciences, it is also widely used in other research fields such as medical, pharmaceutical, food, social and information sciences <span class="citation" data-cites="Murphy2013">(<a href="#ref-Murphy2013" role="doc-biblioref">Murphy et al. 2013</a>)</span>. Until today, more than 1850 published scientific papers relying on PARAFAC have been identified on Web of Science.</p>
<p>Although PARAFAC was made easier using the MATLAB toolbox <span class="citation" data-cites="Murphy2013">(<a href="#ref-Murphy2013" role="doc-biblioref">Murphy et al. 2013</a>)</span>, preprocessing of EEMs prior to the analysis is still not straightforward. EEM preprocessing is an important part of PARAFAC since it aims to correct any systematic bias in the measurements and to remove signal unrelated to DOM fluorescence <span class="citation" data-cites="Murphy2013">(<a href="#ref-Murphy2013" role="doc-biblioref">Murphy et al. 2013</a>)</span>. Biased models can be produced if these steps are not conducted carefully (see <span class="citation" data-cites="Hiriart-Baer2008">Hiriart-Baer, Diep, and Smith (<a href="#ref-Hiriart-Baer2008" role="doc-biblioref">2008</a>)</span> where scattering fluorescence signals have been modeled and wrongly interpreted). Such data processing is cumbersome as it involves many steps <span class="citation" data-cites="Stedmon2008 Murphy2013">(<a href="#ref-Stedmon2008" role="doc-biblioref">Stedmon and Bro 2008</a>; <a href="#ref-Murphy2013" role="doc-biblioref">Murphy et al. 2013</a>)</span> which are usually executed by hand or within in-house scripting and therefore prone to introduce errors. Another important drawback limiting effective preprocessing of EEMs arise from the wide variety of file formats provided by the different manufacturers of spectrofluorometers that makes data importation difficult to generalize.</p>
<p>Possibly reflecting these difficulties, it was recently pointed out that characterization of DOM using fluorescence spectroscopy is still not routinely included in ecological studies <span class="citation" data-cites="Fellman2010">(<a href="#ref-Fellman2010" role="doc-biblioref">Fellman, Hood, and Spencer 2010</a>)</span>. Given the increasing interest for fluorescence spectroscopy in ecology, tools are needed to unify the main preprocessing steps needed for further analyzes such as PARAFAC or metric calculations. The purpose of the package is to provide a rapid and an elegant interface to perform preprocessing of EEMs as well as to extract common fluorescence-based metrics proposed in the literature to obtain quantitative information about the DOM pool. This paper presents theoretical and mathematical background of the main PARAFAC preprocessing steps and metric calculations with concrete code examples.</p>
</section><section class="section level3"><h3 id="fluorescence-of-dom-theoretical-and-mathematical-background">Fluorescence of DOM: theoretical and mathematical background<a class="anchor" aria-label="anchor" href="#fluorescence-of-dom-theoretical-and-mathematical-background"></a>
</h3>
<p>Let us define <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>X</mi><annotation encoding="application/x-tex">X</annotation></semantics></math>, an EEM of fluorescence intensities measured along a vector of excitation wavelengths (<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>e</mi><mi>x</mi></mrow><annotation encoding="application/x-tex">ex</annotation></semantics></math>) at emission wavelengths (<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>e</mi><mi>m</mi></mrow><annotation encoding="application/x-tex">em</annotation></semantics></math>). Usually, <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>e</mi><mi>x</mi></mrow><annotation encoding="application/x-tex">ex</annotation></semantics></math> and <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>e</mi><mi>m</mi></mrow><annotation encoding="application/x-tex">em</annotation></semantics></math> vary, respectively, between 200-500 nm and 220-600 nm (Fig. 1). <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>X</mi><mrow><mi>e</mi><mi>x</mi><mo>,</mo><mi>e</mi><mi>m</mi></mrow></msub><annotation encoding="application/x-tex">X_{ex, em}</annotation></semantics></math> denotes the fluorescence intensity measured at excitation <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>e</mi><mi>x</mi></mrow><annotation encoding="application/x-tex">ex</annotation></semantics></math> and emission <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>e</mi><mi>m</mi></mrow><annotation encoding="application/x-tex">em</annotation></semantics></math> (ex.: <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>X</mi><mrow><mn>250</mn><mo>,</mo><mn>400</mn></mrow></msub><annotation encoding="application/x-tex">X_{250, 400}</annotation></semantics></math>).</p>
<p>The following sections present the main correction steps for fluorescence data aiming to correct any systematic bias in the measurements and remove signal unrelated to fluorescence prior to any analysis.</p>
<table class="table caption-top">
<colgroup>
<col style="width: 19%">
<col style="width: 80%">
</colgroup>
<thead><tr class="header">
<th>Correction</th>
<th style="text-align: center;">Description</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>Blank subtraction</td>
<td style="text-align: center;">Subtract a pure water sample blank from the fluorescence data to help the removal of Raman and Rayleigh scattering peaks.</td>
</tr>
<tr class="even">
<td>Scattering removal</td>
<td style="text-align: center;">Remove the the so-called scattering bands caused by first and second order of Raman and Rayleigh scattering.</td>
</tr>
<tr class="odd">
<td>Inner-filter effect correction</td>
<td style="text-align: center;">Correct for reabsorption of light occurring at both the excitation and emission wavelengths during measurement.</td>
</tr>
<tr class="even">
<td>Raman normalization</td>
<td style="text-align: center;">Remove the dependency of fluorescence intensities from the measuring equipments thus allowing cross-study comparisons.</td>
</tr>
</tbody>
</table>
<section class="level3"><h4 id="scattering-correction">Scattering correction<a class="anchor" aria-label="anchor" href="#scattering-correction"></a>
</h4>
<p>Rayleigh and Raman scattering are optical processes by which some of the incident energy can be absorbed and converted into vibrational and rotational energy <span class="citation" data-cites="Lakowicz2006">(<a href="#ref-Lakowicz2006" role="doc-biblioref">Lakowicz 2006</a>)</span>. The resulting scattered energy produce the so-called scattering bands which are visually easily identifiable (Figs. 1 and 2). Given that both types of scattering are repeated across EEMs, it is important to remove such artifacts prior to analysis <span class="citation" data-cites="Bahram2006 Zepp2004">(<a href="#ref-Bahram2006" role="doc-biblioref">Bahram et al. 2006</a>; <a href="#ref-Zepp2004" role="doc-biblioref">Zepp, Sheldon, and Moran 2004</a>)</span>.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure><p><img src="introduction_files/figure-html/unnamed-chunk-2-1.png" width="480"></p>
<figcaption>Emission fluorescence emitted at excitation <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>e</mi><mi>x</mi><mo>=</mo><mn>350</mn></mrow><annotation encoding="application/x-tex">ex = 350</annotation></semantics></math>. First order of Rayleigh and Raman scattering regions are identified in blue and red.</figcaption></figure>
</div>
</div>
</div>
<p>First order of Rayleigh scattering is defined as the region where emission is equal to excitation (<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>e</mi><mi>m</mi><mo>=</mo><mi>e</mi><mi>x</mi></mrow><annotation encoding="application/x-tex">em = ex</annotation></semantics></math>) causing a diagonal band in the EEM (Fig. 1) whereas the second order of Rayleigh scattering occurs at two times the emission wavelength of the primary peak (<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>e</mi><mi>m</mi><mo>=</mo><mn>2</mn><mi>e</mi><mi>x</mi></mrow><annotation encoding="application/x-tex">em = 2ex</annotation></semantics></math>). For water, Raman scattering occurs at a wavenumber 3 600 <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>c</mi><msup><mi>m</mi><mrow><mi>−</mi><mn>1</mn></mrow></msup></mrow><annotation encoding="application/x-tex">cm^{-1}</annotation></semantics></math> (or <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>3.6</mn><mo>×</mo><msup><mn>10</mn><mn>10</mn></msup><mi>n</mi><msup><mi>m</mi><mrow><mi>−</mi><mn>1</mn></mrow></msup></mrow><annotation encoding="application/x-tex">3.6 \times 10^{10} nm^{-1}</annotation></semantics></math>) lower than the incident excitation wavenumber <span class="citation" data-cites="Lakowicz2006">(<a href="#ref-Lakowicz2006" role="doc-biblioref">Lakowicz 2006</a>)</span>. Mathematically, first order Raman scattering is defined as follow:</p>
<div class="equation">
<ol start="2" class="example" type="1">
<li><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mtext mathvariant="normal">Raman</mtext><mtext mathvariant="normal">1st</mtext></msub><mo>=</mo><mi>−</mi><mfrac><mrow><mi>e</mi><mi>x</mi></mrow><mrow><mn>0.00036</mn><mi>e</mi><mi>x</mi><mo>−</mo><mn>1</mn></mrow></mfrac></mrow><annotation encoding="application/x-tex">\text{Raman}_{\text{1st}} = -\frac{ex}{0.00036 ex - 1}</annotation></semantics></math></li>
</ol>
</div>
<p>where <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>e</mi><mi>x</mi></mrow><annotation encoding="application/x-tex">ex</annotation></semantics></math> is the incident excitation wavelength (nm). Second order Raman scattering is then simply defined as:</p>
<div class="equation">
<ol start="3" class="example" type="1">
<li><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mtext mathvariant="normal">Raman</mtext><mtext mathvariant="normal">2nd</mtext></msub><mo>=</mo><mi>−</mi><mfrac><mrow><mn>2</mn><mi>e</mi><mi>x</mi></mrow><mrow><mn>0.00036</mn><mi>e</mi><mi>x</mi><mo>−</mo><mn>1</mn></mrow></mfrac></mrow><annotation encoding="application/x-tex">\text{Raman}_{\text{2nd}} = -\frac{2ex}{0.00036 ex - 1}</annotation></semantics></math></li>
</ol>
</div>
<p>Different interpolation techniques have been proposed to eliminate scattering <span class="citation" data-cites="Zepp2004 Bahram2006">(<a href="#ref-Zepp2004" role="doc-biblioref">Zepp, Sheldon, and Moran 2004</a>; <a href="#ref-Bahram2006" role="doc-biblioref">Bahram et al. 2006</a>)</span>. However, it is a common practice to simply remove the scattering-bands by inserting missing values (Fig. 3) at the corresponding positions <span class="citation" data-cites="Murphy2013 Stedmon2008">(<a href="#ref-Murphy2013" role="doc-biblioref">Murphy et al. 2013</a>; <a href="#ref-Stedmon2008" role="doc-biblioref">Stedmon and Bro 2008</a>)</span>.</p>
</section><section class="level3"><h4 id="inner-filter-effect-correction">Inner-filter effect correction<a class="anchor" aria-label="anchor" href="#inner-filter-effect-correction"></a>
</h4>
<p>The inner-filter effect (IFE) is an optical phenomenon of reabsorption of emitted light and occurs particularly in highly concentrated samples (Fig. 4). IFE is known to cause underestimation of fluorescence intensities especially at shorter wavelengths and even to alter the shape and the positioning of fluorescence spectra by shifting peak positions toward lower wavelengths (Fig. 4) with increasing concentration <span class="citation" data-cites="Mobed1996 Kothawala2013">(<a href="#ref-Mobed1996" role="doc-biblioref">Mobed et al. 1996</a>; <a href="#ref-Kothawala2013" role="doc-biblioref">Kothawala et al. 2013</a>)</span>. However, it was shown that the loss of fluorescence due to IFE could be estimated from absorbance spectra measured on the same sample using Equation (4) <span class="citation" data-cites="Ohno2002 Parker1957">(<a href="#ref-Ohno2002" role="doc-biblioref">Ohno 2002</a>; <a href="#ref-Parker1957" role="doc-biblioref">Parker and Barnes 1957</a>)</span>:</p>
<div class="equation">
<ol start="4" class="example" type="1">
<li><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>X</mi><mn>0</mn></msub><mo>=</mo><mfrac><mi>X</mi><msup><mn>10</mn><mrow><mi>−</mi><mi>b</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>A</mi><mrow><mi>e</mi><mi>x</mi></mrow></msub><mo>+</mo><msub><mi>A</mi><mrow><mi>e</mi><mi>m</mi></mrow></msub><mo stretchy="true" form="postfix">)</mo></mrow></mrow></msup></mfrac></mrow><annotation encoding="application/x-tex">X_0 = \frac{X}{10^{-b(A_{ex} + A_{em})}}</annotation></semantics></math></li>
</ol>
</div>
<p>where <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>X</mi><mn>0</mn></msub><annotation encoding="application/x-tex">X_0</annotation></semantics></math> is the fluorescence in the absence of IFE, <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>X</mi><annotation encoding="application/x-tex">X</annotation></semantics></math> is the measured fluorescence intensity, <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>b</mi><annotation encoding="application/x-tex">b</annotation></semantics></math> is half the cuvette pathlength (usually 0.5 cm) for excitation and emission absorbance, <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>A</mi><mrow><mi>e</mi><mi>x</mi></mrow></msub><annotation encoding="application/x-tex">A_{ex}</annotation></semantics></math> is the absorbance at the excitation wavelength <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>e</mi><mi>x</mi></mrow><annotation encoding="application/x-tex">ex</annotation></semantics></math> and <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>A</mi><mrow><mi>e</mi><mi>m</mi></mrow></msub><annotation encoding="application/x-tex">A_{em}</annotation></semantics></math> the absorbance at the emission wavelength <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>e</mi><mi>m</mi></mrow><annotation encoding="application/x-tex">em</annotation></semantics></math> (Fig. 4B).</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure><p><img src="introduction_files/figure-html/unnamed-chunk-3-1.png" width="672"></p>
<figcaption>Surface plot of an EEM with first order of Raman and Rayleigh scattering removed. Missing values (<code>NA</code>) have been placed in both diagonals using a bandwidth of 10 nm.</figcaption></figure>
</div>
</div>
</div>
<p>It was recently shown that IFE corrected algebraically was not appropriate when total absorbance, defined as <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>A</mi><mtext mathvariant="normal">total</mtext></msub><mo>=</mo><msub><mi>A</mi><mtext mathvariant="normal">ex</mtext></msub><mo>+</mo><msub><mi>A</mi><mtext mathvariant="normal">em</mtext></msub></mrow><annotation encoding="application/x-tex">A_{\text{total}} = A_{\text{ex}} + A_{\text{em}}</annotation></semantics></math> (see Equation (4)), is greater than 1.5 <span class="citation" data-cites="Kothawala2013">(<a href="#ref-Kothawala2013" role="doc-biblioref">Kothawala et al. 2013</a>)</span>. Under this circumstance, a two-fold dilution of the sample has been recommended. If this happen, a warning message will be displayed by the package during the correction process.</p>
</section><section class="level3"><h4 id="raman-calibration">Raman calibration<a class="anchor" aria-label="anchor" href="#raman-calibration"></a>
</h4>
<p>The same DOM sample measured on different spectrofluorometers (or even the same but with different settings) can give important differences in fluorescence intensities <span class="citation" data-cites="Lawaetz2009 Coble1993">(<a href="#ref-Lawaetz2009" role="doc-biblioref">Lawaetz and Stedmon 2009</a>; <a href="#ref-Coble1993" role="doc-biblioref">Paula G. Coble, Schultz, and Mopper 1993</a>)</span>. The purpose of the Raman calibration is to remove the dependency of fluorescence intensities on the measuring equipment, thus allowing cross-study comparisons. Given that the Raman peak position of a water sample is located at a fixed position, <span class="citation" data-cites="Lawaetz2009">(<a href="#ref-Lawaetz2009" role="doc-biblioref">Lawaetz and Stedmon 2009</a>)</span> proposed to use the Raman integral of a blank-water sample measured the same day as the EEM to perform calibration. Moreover, the area of the Raman peak (<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>A</mi><mtext mathvariant="normal">rp</mtext></msub><annotation encoding="application/x-tex">A_{\text{rp}}</annotation></semantics></math>, Fig. 5) is defined as the area of the emission profile between 371 and 428 nm at a fixed excitation of 350 nm <span class="citation" data-cites="Lawaetz2009">(<a href="#ref-Lawaetz2009" role="doc-biblioref">Lawaetz and Stedmon 2009</a>)</span>.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure><p><img src="introduction_files/figure-html/unnamed-chunk-4-1.png" width="672"></p>
<figcaption>IFE correction process. Panel (A) shows an uncorrected EEM (the color bar is the florescence intensity in A.U.). Panel (B) is the corresponding absorbance spectra measured on the same sample. Panel (C) shows the IFE correction factors corresponding to the values of the denominator in Equation (4) with values close to 1 indicating less pronounced correction. Panel (D) shows the corrected sample (the color bar is the fluorescence intensity in A.U.).</figcaption></figure>
</div>
</div>
</div>
<p>Mathematically, the value of <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>A</mi><mtext mathvariant="normal">rp</mtext></msub><annotation encoding="application/x-tex">A_{\text{rp}}</annotation></semantics></math> is calculated using the following integral (Equation(5)):</p>
<div class="equation">
<ol start="5" class="example" type="1">
<li><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>A</mi><mtext mathvariant="normal">rp</mtext></msub><mo>=</mo><munderover><mo>∫</mo><msub><mi>λ</mi><mrow><mtext mathvariant="normal">em</mtext><mn>371</mn></mrow></msub><msub><mi>λ</mi><mrow><mtext mathvariant="normal">em</mtext><mn>428</mn></mrow></msub></munderover><msub><mi>W</mi><mrow><mn>350</mn><mo>,</mo><mi>λ</mi></mrow></msub><mi>d</mi><mi>λ</mi></mrow><annotation encoding="application/x-tex">A_{\text{rp}} = \int\limits_{\lambda_{\text{em}371}}^{\lambda_{\text{em}428}} W_{350, \lambda} d\lambda</annotation></semantics></math></li>
</ol>
</div>
<p>where <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>W</mi><mrow><mn>350</mn><mo>,</mo><mi>λ</mi></mrow></msub><annotation encoding="application/x-tex">W_{350, \lambda}</annotation></semantics></math> is the fluorescence intensity of a pure water sample (preferably deionized and ultraviolet exposed, <span class="citation" data-cites="Lawaetz2009">Lawaetz and Stedmon (<a href="#ref-Lawaetz2009" role="doc-biblioref">2009</a>)</span>) at excitation <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>e</mi><mi>x</mi><mo>=</mo><mn>350</mn></mrow><annotation encoding="application/x-tex">ex = 350</annotation></semantics></math> nm and at emission <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>e</mi><mi>m</mi><mo>=</mo><mi>λ</mi></mrow><annotation encoding="application/x-tex">em = \lambda</annotation></semantics></math> nm. Each values of the EEM <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>X</mi><annotation encoding="application/x-tex">X</annotation></semantics></math> are then normalized using the scalar value of <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>A</mi><mtext mathvariant="normal">rp</mtext></msub><annotation encoding="application/x-tex">A_{\text{rp}}</annotation></semantics></math> accordingly to Equation (6):</p>
<div class="equation">
<ol start="6" class="example" type="1">
<li><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>X</mi><mn>0</mn></msub><mo>=</mo><mfrac><mi>X</mi><msub><mi>A</mi><mtext mathvariant="normal">rp</mtext></msub></mfrac></mrow><annotation encoding="application/x-tex">X_0 = \frac{X}{A_{\text{rp}}}</annotation></semantics></math></li>
</ol>
</div>
<p>where <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>X</mi><mn>0</mn></msub><annotation encoding="application/x-tex">X_0</annotation></semantics></math> is the normalized EEM with fluorescence intensities now expressed as Raman Units (R.U.), <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>X</mi><annotation encoding="application/x-tex">X</annotation></semantics></math> are the unnormalized measured fluorescence intensities and <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>A</mi><mtext mathvariant="normal">rp</mtext></msub><annotation encoding="application/x-tex">A_{\text{rp}}</annotation></semantics></math> is the Raman peak area.</p>
</section><section class="level3"><h4 id="metrics">Metrics<a class="anchor" aria-label="anchor" href="#metrics"></a>
</h4>
<p>A wide range of different metrics obtained from EEMs have been proposed to characterize the DOM pool in aquatic ecosystems. These metrics extract quantitative information in specific regions (wavelengths) in EEMs. The following sections present an overview of the principal metrics supported by the package.</p>
<section class="level4"><h5 id="cobles-peaks">Coble’s peaks<a class="anchor" aria-label="anchor" href="#cobles-peaks"></a>
</h5>
<p>The following table presents the five major fluorescent components identified by <span class="citation" data-cites="Coble1996">(<a href="#ref-Coble1996" role="doc-biblioref">Paula G. Coble 1996</a>)</span> in marine EEMs. Peaks <strong>B</strong> and <strong>T</strong> represent protein-like compounds (tyrosine and tryptophane), peaks <strong>A</strong> and <strong>C</strong> are indicators of humic-like components whereas peak <strong>M</strong> was associated to marine humic-like fluorescence.</p>
<table class="table caption-top">
<thead><tr class="header">
<th>Peak</th>
<th>Ex (nm)</th>
<th>Em (nm)</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>B</td>
<td>275</td>
<td>310</td>
</tr>
<tr class="even">
<td>T</td>
<td>275</td>
<td>340</td>
</tr>
<tr class="odd">
<td>A</td>
<td>260</td>
<td>380-460</td>
</tr>
<tr class="even">
<td>M</td>
<td>312</td>
<td>380-420</td>
</tr>
<tr class="odd">
<td>C</td>
<td>350</td>
<td>420-480</td>
</tr>
</tbody>
</table></section><section class="level4"><h5 id="fluorescence-humification-and-biological-indices">Fluorescence, humification and biological indices<a class="anchor" aria-label="anchor" href="#fluorescence-humification-and-biological-indices"></a>
</h5>
<p>Three main indices have been proposed to trace the diagnostic state of the DOM pool in aquatic ecosystems. The fluorescence index (FI) was shown to be a good indicator of the general source and aromaticity of DOM in lakes, streams and rivers <span class="citation" data-cites="McKnight2001">(<a href="#ref-McKnight2001" role="doc-biblioref">McKnight et al. 2001</a>)</span>. This index is calculated as the ratio of fluorescence at emission 450 nm and 500 nm, at fixed excitation of 370 nm (Equation (7)).</p>
<div class="equation">
<ol start="7" class="example" type="1">
<li><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext mathvariant="normal">FI</mtext><mo>=</mo><mfrac><msub><mi>X</mi><mrow><mn>370</mn><mo>,</mo><mn>450</mn></mrow></msub><msub><mi>X</mi><mrow><mn>370</mn><mo>,</mo><mn>500</mn></mrow></msub></mfrac></mrow><annotation encoding="application/x-tex">\text{FI} = \frac{X_{370, 450}}{X_{370, 500}}</annotation></semantics></math></li>
</ol>
</div>
<p>The humification index (HIX) is a measure of the complexity and the aromatic nature of DOM <span class="citation" data-cites="Ohno2002">(<a href="#ref-Ohno2002" role="doc-biblioref">Ohno 2002</a>)</span>. HIX calculated as the ratio of the sum of the fluorescence between 435 and 480 nm and between 300 and 345 nm at a fixed excitation of 254 nm (Equation (8)).</p>
<div class="equation">
<ol start="8" class="example" type="1">
<li><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext mathvariant="normal">HIX</mtext><mo>=</mo><mfrac><mrow><munderover><mo>∑</mo><mrow><mi>e</mi><mi>m</mi><mo>=</mo><mn>435</mn></mrow><mn>480</mn></munderover><msub><mi>X</mi><mrow><mn>254</mn><mo>,</mo><mi>e</mi><mi>m</mi></mrow></msub></mrow><mrow><munderover><mo>∑</mo><mrow><mi>e</mi><mi>m</mi><mo>=</mo><mn>300</mn></mrow><mn>345</mn></munderover><msub><mi>X</mi><mrow><mn>254</mn><mo>,</mo><mi>e</mi><mi>m</mi></mrow></msub></mrow></mfrac></mrow><annotation encoding="application/x-tex">\text{HIX} = \frac{\sum\limits_{em = 435}^{480} X_{254, em}}{\sum\limits_{em = 300}^{345} X_{254, em}}</annotation></semantics></math></li>
</ol>
</div>
<p>The biological index (BIX) is a measure to characterize biological production of DOM <span class="citation" data-cites="Huguet2009">(<a href="#ref-Huguet2009" role="doc-biblioref">Huguet et al. 2009</a>)</span>. BIX is calculated at excitation 310 nm, by dividing the fluorescence intensity emitted at emission 380 nm and at 430 nm (Equation (9)).</p>
<div class="equation">
<ol start="9" class="example" type="1">
<li><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext mathvariant="normal">BIX</mtext><mo>=</mo><mfrac><msub><mi>X</mi><mrow><mn>310</mn><mo>,</mo><mn>380</mn></mrow></msub><msub><mi>X</mi><mrow><mn>310</mn><mo>,</mo><mn>430</mn></mrow></msub></mfrac></mrow><annotation encoding="application/x-tex">\text{BIX} = \frac{X_{310, 380}}{X_{310, 430}}</annotation></semantics></math></li>
</ol>
</div>
</section></section></section><section class="section level3"><h3 id="r-code-and-study-case">R code and study case<a class="anchor" aria-label="anchor" href="#r-code-and-study-case"></a>
</h3>
<p>Main preprocessing steps using the <strong>eemR</strong> package are illustrated using a subset of three EEMs from <span class="citation" data-cites="Massicotte2011EA">(<a href="#ref-Massicotte2011EA" role="doc-biblioref">Massicotte and Frenette 2011</a>)</span>. Briefly, these EEMs (see Fig. 1 for an example) have been sampled in the St. Lawrence River, one of the largest rivers in North America. Fluorescence matrices of DOM were measured on a Cary Eclipse spectrofluorometer (Varian, Mississauga, Ontario, Canada) over excitation wavelengths between 220 and 450 nm (5-nm increment) and emission wavelengths between 230 and 600 nm (2-nm increment). All functions from the package start with the prefix <code>'eem_'</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/PMassicotte/eemR" class="external-link">eemR</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/ls.html" class="external-link">ls</a></span><span class="op">(</span><span class="st">"package:eemR"</span><span class="op">)</span></span>
<span><span class="co">#&gt;  [1] "absorbance"              "eem_bind"               </span></span>
<span><span class="co">#&gt;  [3] "eem_biological_index"    "eem_coble_peaks"        </span></span>
<span><span class="co">#&gt;  [5] "eem_cut"                 "eem_export_matlab"      </span></span>
<span><span class="co">#&gt;  [7] "eem_extract"             "eem_fluorescence_index" </span></span>
<span><span class="co">#&gt;  [9] "eem_humification_index"  "eem_inner_filter_effect"</span></span>
<span><span class="co">#&gt; [11] "eem_names"               "eem_names&lt;-"            </span></span>
<span><span class="co">#&gt; [13] "eem_peaks"               "eem_raman_normalisation"</span></span>
<span><span class="co">#&gt; [15] "eem_read"                "eem_remove_blank"       </span></span>
<span><span class="co">#&gt; [17] "eem_remove_scattering"   "eem_set_wavelengths"</span></span></code></pre></div>
</div>
<section class="level3"><h4 id="data-importation-and-plotting">Data importation and plotting<a class="anchor" aria-label="anchor" href="#data-importation-and-plotting"></a>
</h4>
<p>Importation of EEMs into is done using the <code><a href="../reference/eem_read.html">eem_read()</a></code> function. Given that fluorescence files are dependent on the spectrofluorometer used, will determine automatically from which manufacturer the files are from and load them accordingly.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">file</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata/cary/scans_day_1"</span>, package <span class="op">=</span> <span class="st">"eemR"</span><span class="op">)</span></span>
<span><span class="va">eems</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/eem_read.html">eem_read</a></span><span class="op">(</span><span class="va">file</span>, import_function <span class="op">=</span> <span class="st">"cary"</span><span class="op">)</span></span></code></pre></div>
</div>
<p>The generic <code><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary()</a></code> function displays useful information such as: (1) the wavelength ranges used in both emission and excitation modes, (2) the manufacturer from which the file was read and (3) the state of the EEM which indicate which corrections have been applied.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">eems</span><span class="op">)</span></span>
<span><span class="co">#&gt;    sample ex_min ex_max em_min em_max is_blank_corrected is_scatter_corrected</span></span>
<span><span class="co">#&gt; 1    nano    220    450    230    600              FALSE                FALSE</span></span>
<span><span class="co">#&gt; 2 sample1    220    450    230    600              FALSE                FALSE</span></span>
<span><span class="co">#&gt; 3 sample2    220    450    230    600              FALSE                FALSE</span></span>
<span><span class="co">#&gt; 4 sample3    220    450    230    600              FALSE                FALSE</span></span>
<span><span class="co">#&gt;   is_ife_corrected is_raman_normalized</span></span>
<span><span class="co">#&gt; 1            FALSE               FALSE</span></span>
<span><span class="co">#&gt; 2            FALSE               FALSE</span></span>
<span><span class="co">#&gt; 3            FALSE               FALSE</span></span>
<span><span class="co">#&gt; 4            FALSE               FALSE</span></span></code></pre></div>
</div>
<p>A surface plot of EEMs is made using the <code>plot(x, which = 1)</code> function where <code>which</code> is the index of the EEM to be plotted (see Fig. 3).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">eems</span>, which <span class="op">=</span> <span class="fl">3L</span><span class="op">)</span></span></code></pre></div>
</div>
<p>Interactive plots using a simple shiny app can be lunched to interactively browse EEMs.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">eems</span>, interactive <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
</div>
</section><section class="level3"><h4 id="blank-subtraction">Blank subtraction<a class="anchor" aria-label="anchor" href="#blank-subtraction"></a>
</h4>
<p>Subtraction of a water blank from the measured samples may help to reduce scattering <span class="citation" data-cites="Murphy2013 Stedmon2008">(<a href="#ref-Murphy2013" role="doc-biblioref">Murphy et al. 2013</a>; <a href="#ref-Stedmon2008" role="doc-biblioref">Stedmon and Bro 2008</a>)</span>. In , this is done using the <code>eem_remove_blank(eem, blank)</code> function where <code>eem</code> is a list of EEMs and <code>blank</code> is a water blank.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">file</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata/cary/scans_day_1"</span>, <span class="st">"nano.csv"</span>, package <span class="op">=</span> <span class="st">"eemR"</span><span class="op">)</span></span>
<span><span class="va">blank</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/eem_read.html">eem_read</a></span><span class="op">(</span><span class="va">file</span>, import_function <span class="op">=</span> <span class="st">"cary"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">eems</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/eem_remove_blank.html">eem_remove_blank</a></span><span class="op">(</span><span class="va">eems</span>, <span class="va">blank</span><span class="op">)</span></span></code></pre></div>
</div>
</section><section class="level3"><h4 id="raman-and-rayleigh-scattering-removal">Raman and Rayleigh scattering removal<a class="anchor" aria-label="anchor" href="#raman-and-rayleigh-scattering-removal"></a>
</h4>
<p>Scattering removal (Equation (2) and Equation (3)) is performed using the <code>eem_remove_scattering(eem, type, order, width)</code> function where <code>eem</code> is a list of EEMs, <code>type</code> is the scattering type (<code>raman</code> or <code>rayleigh</code>), <code>order</code> is the order of the scattering (1 or 2) and <code>width</code> the width in nanometers of the slit windows to be removed. In the following example, only first order and Raman and Rayleigh scattering are removed using a bandwidth of 10 nm (Fig. 3).</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">eems</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/eem_remove_scattering.html">eem_remove_scattering</a></span><span class="op">(</span><span class="va">eems</span>, <span class="st">"rayleigh"</span>, <span class="fl">1L</span>, <span class="fl">10L</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/eem_remove_scattering.html">eem_remove_scattering</a></span><span class="op">(</span><span class="st">"raman"</span>, <span class="fl">1L</span>, <span class="fl">10L</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">eems</span>, which <span class="op">=</span> <span class="fl">3L</span><span class="op">)</span></span></code></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure><p><img src="introduction_files/figure-html/unnamed-chunk-11-1.png" width="480"></p>
<figcaption>Fluorescence profile of a pure water sample at excitation 350 nm between 300 and 450 nm emission. The area of the Raman peak is identified by the shaded polygon and is calculated using Equation (5).</figcaption></figure>
</div>
</div>
</div>
</section><section class="level3"><h4 id="inner-filter-effect-correction-1">Inner-filter effect correction<a class="anchor" aria-label="anchor" href="#inner-filter-effect-correction-1"></a>
</h4>
<p>IFE correction requires the use of absorbance data (Equation (4)). For each EEM, an absorbance spectra must be supplied. The easiest way to provide absorbance is to use a data frame with column names matching EEMs names. In the following data frame, the first column represents the wavelengths at which absorbance have been measured whereas the remaining columns are absorbance spectra for <code>sample1</code>, <code>sample2</code> and <code>sample3</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"absorbance"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">absorbance</span><span class="op">)</span></span>
<span><span class="co">#&gt;   wavelength sample1 sample2 sample3</span></span>
<span><span class="co">#&gt; 1        190 0.89674 1.02927 1.19405</span></span>
<span><span class="co">#&gt; 2        191 0.84894 0.96381 1.13721</span></span>
<span><span class="co">#&gt; 3        192 0.77267 0.85339 1.04520</span></span>
<span><span class="co">#&gt; 4        193 0.70967 0.75627 0.96782</span></span>
<span><span class="co">#&gt; 5        194 0.65459 0.67145 0.90092</span></span>
<span><span class="co">#&gt; 6        195 0.61371 0.60745 0.85054</span></span></code></pre></div>
</div>
<p>Note that EEM names can be obtained using the <code>eem_sample_names()</code> function.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/eem_names.html">eem_names</a></span><span class="op">(</span><span class="va">eems</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "nano"    "sample1" "sample2" "sample3"</span></span></code></pre></div>
</div>
<p>IFE correction is performed using the <code>eem_inner_filter_effect(eem, absorbance, pathlength)</code> function where <code>eem</code> is a list of EEMs, <code>absorbance</code> is a data frame containing absorbance spectra and <code>pathlength</code> is the absorbance cuvette pathlength expressed in <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>c</mi><mi>m</mi></mrow><annotation encoding="application/x-tex">cm</annotation></semantics></math> (Fig. 4B). For each EEM contained in <code>eem</code>, the ranges spanned by the IFE correction factors and total absorbance <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>A</mi><mtext mathvariant="normal">total</mtext></msub><annotation encoding="application/x-tex">A_{\text{total}}</annotation></semantics></math> (Equation (4)) are displayed to the user. This can serve as diagnostic tool to determine if the mathematical correction was the appropriate method to use to handle IFE.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">eems</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/eem_inner_filter_effect.html">eem_inner_filter_effect</a></span><span class="op">(</span></span>
<span>  eem <span class="op">=</span> <span class="va">eems</span>,</span>
<span>  absorbance <span class="op">=</span> <span class="va">absorbance</span>,</span>
<span>  pathlength <span class="op">=</span> <span class="fl">1L</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning: Absorbance spectrum for nano was not found. Returning uncorrected EEM.</span></span>
<span><span class="co">#&gt; sample1 </span></span>
<span><span class="co">#&gt; Range of IFE correction factors: 1.0112 1.5546 </span></span>
<span><span class="co">#&gt; Range of total absorbance (Atotal) : 0.0096 0.3832 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; sample2 </span></span>
<span><span class="co">#&gt; Range of IFE correction factors: 1.0061 1.3124 </span></span>
<span><span class="co">#&gt; Range of total absorbance (Atotal) : 0.0053 0.2362 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; sample3 </span></span>
<span><span class="co">#&gt; Range of IFE correction factors: 1.016 2.3713 </span></span>
<span><span class="co">#&gt; Range of total absorbance (Atotal) : 0.0138 0.75</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">eems</span>, which <span class="op">=</span> <span class="fl">3L</span><span class="op">)</span></span></code></pre></div>
</div>
<p>Fig. 4 presents intermediate results obtained for the correction of <code>sample3</code>. Note the nonlinearity of the correction with higher effect at lower wavelengths (bottom-left corner in panel C). The corrected EEM is presented in Fig. 4D which is the result of the operation of dividing matrix in 4A by 4C.</p>
</section><section class="level3"><h4 id="raman-normalization">Raman normalization<a class="anchor" aria-label="anchor" href="#raman-normalization"></a>
</h4>
<p>The last step of the correction process consist to calibrate fluorescence intensities using the Raman scatter peak of water <span class="citation" data-cites="Lawaetz2009">(<a href="#ref-Lawaetz2009" role="doc-biblioref">Lawaetz and Stedmon 2009</a>)</span>. This is performed using the <code>eem_raman_normalisation(eem, blank)</code> function where <code>eem</code> is a list of EEMs and <code>blank</code> is a water blank measured the same day. Here, the same water-blank is used for the three EEMs. Note that the value of the Raman area (<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>A</mi><mtext mathvariant="normal">rp</mtext></msub><annotation encoding="application/x-tex">A_{\text{rp}}</annotation></semantics></math>, Equation(5)) is printed.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">eems</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/eem_raman_normalisation.html">eem_raman_normalisation</a></span><span class="op">(</span><span class="va">eems</span>, <span class="va">blank</span><span class="op">)</span></span>
<span><span class="co">#&gt; Raman area: 9.540904 </span></span>
<span><span class="co">#&gt; Raman area: 9.540904 </span></span>
<span><span class="co">#&gt; Raman area: 9.540904</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">eems</span>, which <span class="op">=</span> <span class="fl">3L</span><span class="op">)</span></span></code></pre></div>
</div>
<p>At this stage, all corrections have been performed and EEMs are ready to be exported into MATLAB for PARAFAC analysis. The state of the EEMs can be verified using the <code><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary()</a></code> function.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">eems</span><span class="op">)</span></span>
<span><span class="co">#&gt;    sample ex_min ex_max em_min em_max is_blank_corrected is_scatter_corrected</span></span>
<span><span class="co">#&gt; 1    nano    220    450    230    600              FALSE                 TRUE</span></span>
<span><span class="co">#&gt; 2 sample1    220    450    230    600               TRUE                 TRUE</span></span>
<span><span class="co">#&gt; 3 sample2    220    450    230    600               TRUE                 TRUE</span></span>
<span><span class="co">#&gt; 4 sample3    220    450    230    600               TRUE                 TRUE</span></span>
<span><span class="co">#&gt;   is_ife_corrected is_raman_normalized</span></span>
<span><span class="co">#&gt; 1            FALSE               FALSE</span></span>
<span><span class="co">#&gt; 2             TRUE                TRUE</span></span>
<span><span class="co">#&gt; 3             TRUE                TRUE</span></span>
<span><span class="co">#&gt; 4             TRUE                TRUE</span></span></code></pre></div>
</div>
</section><section class="level3"><h4 id="exporting-to-matlab">Exporting to MATLAB<a class="anchor" aria-label="anchor" href="#exporting-to-matlab"></a>
</h4>
<p>The <strong>drEEM</strong> MATLAB toolbox <span class="citation" data-cites="Murphy2013">(<a href="#ref-Murphy2013" role="doc-biblioref">Murphy et al. 2013</a>)</span> used to perform PARAFAC analysis requires data in a specific format (structure). The <code>eem_export_matlab(file, ...)</code> function can be used to export corrected EEMs into a PARAFAC ready format. The first <code>file</code> argument is the mat file where to export the structure and the second argument <code>...</code> is one or more <code>eem</code> object.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/eem_export_matlab.html">eem_export_matlab</a></span><span class="op">(</span><span class="st">"myfile.mat"</span>, <span class="va">eems</span><span class="op">)</span></span></code></pre></div>
</div>
<p>Once exported, one can simply import the generated mat file in MATLAB using <code>load('myfile.mat');</code>.</p>
</section><section class="level3"><h4 id="metric-extraction">Metric extraction<a class="anchor" aria-label="anchor" href="#metric-extraction"></a>
</h4>
<p>Coble’s peaks can be extracted using the <code>eem_coble_peaks(eem)</code> function. Note that for peaks <strong>A, M, C</strong>, the maximum fluorescence intensity in the range of emission region is returned.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">file</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata/cary/scans_day_1"</span>, package <span class="op">=</span> <span class="st">"eemR"</span><span class="op">)</span></span>
<span><span class="va">eems</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/eem_read.html">eem_read</a></span><span class="op">(</span><span class="va">file</span>, import_function <span class="op">=</span> <span class="st">"cary"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="../reference/eem_coble_peaks.html">eem_coble_peaks</a></span><span class="op">(</span><span class="va">eems</span>, verbose <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="co">#&gt;    sample         b         t        a          m         c</span></span>
<span><span class="co">#&gt; 1    nano 0.8745673 0.1401188 0.140175 0.09653326 0.1255788</span></span>
<span><span class="co">#&gt; 2 sample1 1.5452981 1.0603312 3.731836 2.42409567 1.8149415</span></span>
<span><span class="co">#&gt; 3 sample2 1.2629968 0.6647042 1.583489 1.02359302 0.7709074</span></span>
<span><span class="co">#&gt; 4 sample3 1.4740862 1.3162812 8.416034 6.06335506 6.3179129</span></span></code></pre></div>
</div>
<p>Fluorescence (FI), humification (HIX) and biological (BIX) indices can be extracted as follow.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/eem_fluorescence_index.html">eem_fluorescence_index</a></span><span class="op">(</span><span class="va">eems</span>, verbose <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="co">#&gt;    sample         fi</span></span>
<span><span class="co">#&gt; 1    nano -0.5932057</span></span>
<span><span class="co">#&gt; 2 sample1  1.2647823</span></span>
<span><span class="co">#&gt; 3 sample2  1.4553330</span></span>
<span><span class="co">#&gt; 4 sample3  1.3294132</span></span>
<span></span>
<span><span class="fu"><a href="../reference/eem_humification_index.html">eem_humification_index</a></span><span class="op">(</span><span class="va">eems</span>, verbose <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="co">#&gt;    sample        hix</span></span>
<span><span class="co">#&gt; 1    nano  0.5568136</span></span>
<span><span class="co">#&gt; 2 sample1  6.3795618</span></span>
<span><span class="co">#&gt; 3 sample2  4.2548483</span></span>
<span><span class="co">#&gt; 4 sample3 13.0246234</span></span>
<span></span>
<span><span class="fu"><a href="../reference/eem_biological_index.html">eem_biological_index</a></span><span class="op">(</span><span class="va">eems</span>, verbose <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="co">#&gt;    sample       bix</span></span>
<span><span class="co">#&gt; 1    nano 2.6812045</span></span>
<span><span class="co">#&gt; 2 sample1 0.7062640</span></span>
<span><span class="co">#&gt; 3 sample2 0.8535423</span></span>
<span><span class="co">#&gt; 4 sample3 0.4867927</span></span></code></pre></div>
</div>
<p>It should be noted that different excitation and emission wavelengths are often used to measure EEMs. Hence, it is possible to have mismatch between measured wavelengths and wavelengths used to calculate specific metrics. In these circumstances, EEMs are interpolated using the the package <span class="citation" data-cites="Borchers2015">(<a href="#ref-Borchers2015" role="doc-biblioref">Borchers 2015</a>)</span>. A message warning the user will be displayed if data interpolation is performed. This behavior can be controlled using the <code>verbose = TRUE/FALSE</code> parameter.</p>
</section></section><section class="section level3"><h3 id="using-r-pipeline">Using R pipeline<a class="anchor" aria-label="anchor" href="#using-r-pipeline"></a>
</h3>
<p>Note that it is also possible to use the <a href="https://CRAN.R-project.org/package=magrittr" class="external-link">magrittr</a> pipe line with most functions from <code>eemR</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">file</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata/cary/scans_day_1/"</span>, package <span class="op">=</span> <span class="st">"eemR"</span><span class="op">)</span></span>
<span><span class="va">file</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/eem_read.html">eem_read</a></span><span class="op">(</span>recursive <span class="op">=</span> <span class="cn">TRUE</span>, import_function <span class="op">=</span> <span class="st">"cary"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/eem_raman_normalisation.html">eem_raman_normalisation</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/eem_remove_scattering.html">eem_remove_scattering</a></span><span class="op">(</span>type <span class="op">=</span> <span class="st">"raman"</span>, order <span class="op">=</span> <span class="fl">1L</span>, width <span class="op">=</span> <span class="fl">10L</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/eem_remove_scattering.html">eem_remove_scattering</a></span><span class="op">(</span>type <span class="op">=</span> <span class="st">"rayleigh"</span>, order <span class="op">=</span> <span class="fl">1L</span>, width <span class="op">=</span> <span class="fl">10L</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="fl">2L</span><span class="op">)</span></span></code></pre></div>
</div>
</section><section class="section level3"><h3 id="conclusion">Conclusion<a class="anchor" aria-label="anchor" href="#conclusion"></a>
</h3>
<p> provides a flexible interface for manipulating and preprocessing fluorescence matrices based on theoretical and mathematical foundations of fluorescence spectroscopy <span class="citation" data-cites="Lakowicz2006">(<a href="#ref-Lakowicz2006" role="doc-biblioref">Lakowicz 2006</a>)</span>. Furthermore, this package removes the drawbacks associated with EEM manipulation (dependent on spectrofluorometer manufacturer) and unifies the most important steps involved in EEM preparation in order to correct and remove systematic bias in fluorescence measurements. This will likely contribute to promote the use of fluorescence spectroscopy in various fields.</p>
</section><section class="section level3"><h3 class="unnumbered" id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h3>
<div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" role="list">
<div id="ref-Bahram2006" class="csl-entry" role="listitem">
Bahram, Morteza, Rasmus Bro, Colin Stedmon, and Abbas Afkhami. 2006. <span>“<span class="nocase">Handling of Rayleigh and Raman scatter for PARAFAC modeling of fluorescence data using interpolation</span>.”</span> <em>Journal of Chemometrics</em> 20 (3-4): 99–105. <a href="https://doi.org/10.1002/cem.978" class="external-link">https://doi.org/10.1002/cem.978</a>.
</div>
<div id="ref-Benner2002" class="csl-entry" role="listitem">
Benner, R. 2002. <span>“<span class="nocase">Chemical composition and reactivity</span>.”</span> In <em>Biogeochemistry of Marine Dissolved Organic Matter</em>, edited by Dennis A Hansell and Craig A Carlson, 59–90. San Diego, CA: Academic Press.
</div>
<div id="ref-Borchers2015" class="csl-entry" role="listitem">
Borchers, Hans Werner. 2015. <em><span class="nocase">pracma: Practical Numerical Math Functions</span></em>. <a href="https://cran.r-project.org/package=pracma" class="external-link">https://cran.r-project.org/package=pracma</a>.
</div>
<div id="ref-Bro1997" class="csl-entry" role="listitem">
Bro, Rasmus. 1997. <span>“<span class="nocase">PARAFAC. Tutorial and applications</span>.”</span> <em>Chemometrics and Intelligent Laboratory Systems</em> 38 (2): 149–71. <a href="https://doi.org/10.1016/S0169-7439(97)00032-4" class="external-link">https://doi.org/10.1016/S0169-7439(97)00032-4</a>.
</div>
<div id="ref-Coble1996" class="csl-entry" role="listitem">
Coble, Paula G. 1996. <span>“<span class="nocase">Characterization of marine and terrestrial DOM in seawater using excitation-emission matrix spectroscopy</span>.”</span> <em>Marine Chemistry</em> 51 (4): 325–46. <a href="https://doi.org/10.1016/0304-4203(95)00062-3" class="external-link">https://doi.org/10.1016/0304-4203(95)00062-3</a>.
</div>
<div id="ref-Coble1990" class="csl-entry" role="listitem">
Coble, Paula G, Sarah A Green, Neil V Blough, and Robert B Gagosian. 1990. <span>“<span class="nocase">Characterization of dissolved organic matter in the Black Sea by fluorescence spectroscopy</span>.”</span> <em>Nature</em> 348 (6300): 432–35. <a href="https://doi.org/10.1038/348432a0" class="external-link">https://doi.org/10.1038/348432a0</a>.
</div>
<div id="ref-Coble1993" class="csl-entry" role="listitem">
Coble, Paula G., Christopher a. Schultz, and Kenneth Mopper. 1993. <span>“<span class="nocase">Fluorescence contouring analysis of DOC intercalibration experiment samples: a comparison of techniques</span>.”</span> <em>Marine Chemistry</em> 41 (1-3): 173–78. <a href="https://doi.org/10.1016/0304-4203(93)90116-6" class="external-link">https://doi.org/10.1016/0304-4203(93)90116-6</a>.
</div>
<div id="ref-Cole2007" class="csl-entry" role="listitem">
Cole, J J, Y T Prairie, N F Caraco, W H McDowell, L J Tranvik, R G Striegl, C M Duarte, et al. 2007. <span>“<span class="nocase">Plumbing the Global Carbon Cycle: Integrating Inland Waters into the Terrestrial Carbon Budget</span>.”</span> <em>Ecosystems</em> 10 (1): 172–85. <a href="https://doi.org/10.1007/s10021-006-9013-8" class="external-link">https://doi.org/10.1007/s10021-006-9013-8</a>.
</div>
<div id="ref-Fellman2010" class="csl-entry" role="listitem">
Fellman, Jason B, Eran Hood, and Robert G M Spencer. 2010. <span>“<span class="nocase">Fluorescence spectroscopy opens new windows into dissolved organic matter dynamics in freshwater ecosystems: A review</span>.”</span> <em>Limnology and Oceanography</em> 55 (6): 2452–62. <a href="https://doi.org/10.4319/lo.2010.55.6.2452" class="external-link">https://doi.org/10.4319/lo.2010.55.6.2452</a>.
</div>
<div id="ref-Foreman2003" class="csl-entry" role="listitem">
Foreman, C. M., and J. S. Covert. 2003. <span>“<span class="nocase">Linkages between Dissolved Organic Matter Composition and Bacterial Community Structure</span>.”</span> In <em>Aquatic Ecosystems : Interactivity of Dissolved Organic Matter</em>, 343–62. Elsevier. <a href="https://doi.org/10.1016/B978-012256371-3/50015-9" class="external-link">https://doi.org/10.1016/B978-012256371-3/50015-9</a>.
</div>
<div id="ref-Harshman1970" class="csl-entry" role="listitem">
Harshman, Richard a. 1970. <span>“<span class="nocase">Foundations of the PARAFAC procedure: Models and conditions for an <span>‘explanatory’</span> multimodal factor analysis</span>.”</span> <em>UCLA Working Papers in Phonetics</em> 16 (10): 1–84.
</div>
<div id="ref-Hiriart-Baer2008" class="csl-entry" role="listitem">
Hiriart-Baer, Véronique P., Ngan Diep, and Ralph E. H. Smith. 2008. <span>“<span class="nocase">Dissolved Organic Matter in the Great Lakes: Role and Nature of Allochthonous Material</span>.”</span> <em>Journal of Great Lakes Research</em> 34 (3): 383–94.
</div>
<div id="ref-Huguet2009" class="csl-entry" role="listitem">
Huguet, A., L. Vacher, S. Relexans, S. Saubusse, J. M. Froidefond, and E. Parlanti. 2009. <span>“<span class="nocase">Properties of fluorescent dissolved organic matter in the Gironde Estuary</span>.”</span> <em>Organic Geochemistry</em> 40 (6): 706–19. <a href="https://doi.org/10.1016/j.orggeochem.2009.03.002" class="external-link">https://doi.org/10.1016/j.orggeochem.2009.03.002</a>.
</div>
<div id="ref-Kirk1994" class="csl-entry" role="listitem">
Kirk, John T O. 1994. <em><span class="nocase">Light and photosynthesis in aquatic ecosystems</span></em>. 2nd ed. Cambridge [England] ; New York: Cambridge University Press.
</div>
<div id="ref-Kothawala2013" class="csl-entry" role="listitem">
Kothawala, Dolly N., Kathleen R. Murphy, Colin A. Stedmon, Gesa A. Weyhenmeyer, and Lars J. Tranvik. 2013. <span>“<span class="nocase">Inner filter correction of dissolved organic matter fluorescence</span>.”</span> <em>Limnology and Oceanography: Methods</em> 11 (12): 616–30. <a href="https://doi.org/10.4319/lom.2013.11.616" class="external-link">https://doi.org/10.4319/lom.2013.11.616</a>.
</div>
<div id="ref-Kritzberg2006a" class="csl-entry" role="listitem">
Kritzberg, Emma S, Jonathan J Cole, Michael M Pace, and Wilhelm Granéli. 2006. <span>“<span class="nocase">Bacterial Growth on Allochthonous Carbon in Humic and Nutrient-enriched Lakes: Results from Whole-Lake 13C Addition Experiments</span>.”</span> <em>Ecosystems</em> 9 (3): 489–99. <a href="https://doi.org/10.1007/s10021-005-0115-5" class="external-link">https://doi.org/10.1007/s10021-005-0115-5</a>.
</div>
<div id="ref-Lakowicz2006" class="csl-entry" role="listitem">
Lakowicz, Joseph R. 2006. <em><span class="nocase">Principles of Fluorescence Spectroscopy</span></em>. Edited by Joseph R. Lakowicz. Boston, MA: Springer-Verlag. <a href="https://doi.org/10.1007/978-0-387-46312-4" class="external-link">https://doi.org/10.1007/978-0-387-46312-4</a>.
</div>
<div id="ref-Lawaetz2009" class="csl-entry" role="listitem">
Lawaetz, A J, and C A Stedmon. 2009. <span>“<span class="nocase">Fluorescence Intensity Calibration Using the Raman Scatter Peak of Water</span>.”</span> <em>Applied Spectroscopy</em> 63 (8): 936–40. <a href="https://doi.org/10.1366/000370209788964548" class="external-link">https://doi.org/10.1366/000370209788964548</a>.
</div>
<div id="ref-Massicotte2011EA" class="csl-entry" role="listitem">
Massicotte, Philippe, and Jean-Jacques Frenette. 2011. <span>“<span class="nocase">Spatial connectivity in a large river system: resolving the sources and fate of dissolved organic matter</span>.”</span> <em>Ecological Applications</em> 21 (7): 2600–2617. <a href="https://doi.org/10.1890/10-1475.1" class="external-link">https://doi.org/10.1890/10-1475.1</a>.
</div>
<div id="ref-McKnight2001" class="csl-entry" role="listitem">
McKnight, Diane M., Elizabeth W. Boyer, Paul K. Westerhoff, Peter T. Doran, Thomas Kulbe, and Dale T. Andersen. 2001. <span>“<span class="nocase">Spectrofluorometric characterization of dissolved organic matter for indication of precursor organic material and aromaticity</span>.”</span> <em>Limnology and Oceanography</em> 46 (1): 38–48. <a href="https://doi.org/10.4319/lo.2001.46.1.0038" class="external-link">https://doi.org/10.4319/lo.2001.46.1.0038</a>.
</div>
<div id="ref-Mobed1996" class="csl-entry" role="listitem">
Mobed, Jarafshan J, Sherry L Hemmingsen, Jennifer L Autry, and Linda B McGown. 1996. <span>“<span class="nocase">Fluorescence Characterization of IHSS Humic Substances: Total Luminescence Spectra with Absorbance Correction</span>.”</span> <em>Environmental Science <span>&amp;</span> Technology</em> 30 (10): 3061–65. <a href="https://doi.org/10.1021/es960132l" class="external-link">https://doi.org/10.1021/es960132l</a>.
</div>
<div id="ref-Murphy2013" class="csl-entry" role="listitem">
Murphy, Kathleen R., Colin a. Stedmon, Daniel Graeber, and Rasmus Bro. 2013. <span>“<span class="nocase">Fluorescence spectroscopy and multi-way techniques. PARAFAC</span>.”</span> <em>Analytical Methods</em> 5 (23): 6557. <a href="https://doi.org/10.1039/c3ay41160e" class="external-link">https://doi.org/10.1039/c3ay41160e</a>.
</div>
<div id="ref-Ohno2002" class="csl-entry" role="listitem">
Ohno, Tsutomu. 2002. <span>“<span class="nocase">Fluorescence Inner-Filtering Correction for Determining the Humification Index of Dissolved Organic Matter</span>.”</span> <em>Environmental Science <span>&amp;</span> Technology</em> 36 (4): 742–46. <a href="https://doi.org/10.1021/es0155276" class="external-link">https://doi.org/10.1021/es0155276</a>.
</div>
<div id="ref-Parker1957" class="csl-entry" role="listitem">
Parker, C. a., and W. J. Barnes. 1957. <span>“<span class="nocase">Some experiments with spectrofluorimeters and filter fluorimeters</span>.”</span> <em>The Analyst</em> 82 (978): 606. <a href="https://doi.org/10.1039/an9578200606" class="external-link">https://doi.org/10.1039/an9578200606</a>.
</div>
<div id="ref-Seitzinger2005" class="csl-entry" role="listitem">
Seitzinger, S P, H Hartnett, R Lauck, M Mazurek, T Minegishi, G Spyres, and R Styles. 2005. <span>“<span class="nocase">Molecular-level chemical characterization and bioavailability of dissolved organic matter in stream water using electrospray-ionization mass spectrometry</span>.”</span> <em>Limnology and Oceanography</em> 50 (1): 1–12. <a href="https://doi.org/10.4319/lo.2005.50.1.0001" class="external-link">https://doi.org/10.4319/lo.2005.50.1.0001</a>.
</div>
<div id="ref-Stedmon2008" class="csl-entry" role="listitem">
Stedmon, Colin A, and Rasmus Bro. 2008. <span>“<span class="nocase">Characterizing dissolved organic matter fluorescence with parallel factor analysis: a tutorial</span>.”</span> <em>Limnology and Oceanography: Methods</em> 6 (11): 572–79. <a href="https://doi.org/10.4319/lom.2008.6.572" class="external-link">https://doi.org/10.4319/lom.2008.6.572</a>.
</div>
<div id="ref-Stedmon2003a" class="csl-entry" role="listitem">
Stedmon, Colin A, Stiig Markager, and Rasmus Bro. 2003. <span>“<span class="nocase">Tracing dissolved organic matter in aquatic environments using a new approach to fluorescence spectroscopy</span>.”</span> <em>Marine Chemistry</em> 82 (3-4): 239–54. <a href="https://doi.org/10.1016/S0304-4203(03)00072-0" class="external-link">https://doi.org/10.1016/S0304-4203(03)00072-0</a>.
</div>
<div id="ref-Zepp2004" class="csl-entry" role="listitem">
Zepp, Richard G, Wade M Sheldon, and Mary Ann Moran. 2004. <span>“<span class="nocase">Dissolved organic fluorophores in southeastern US coastal waters: correction method for eliminating Rayleigh and Raman scattering peaks in excitation–emission matrices</span>.”</span> <em>Marine Chemistry</em> 89 (1-4): 15–36. <a href="https://doi.org/10.1016/j.marchem.2004.02.006" class="external-link">https://doi.org/10.1016/j.marchem.2004.02.006</a>.
</div>
</div>
</section><script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'light-border',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config);
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script></main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Philippe Massicotte.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer>
</div>





  </body>
</html>
